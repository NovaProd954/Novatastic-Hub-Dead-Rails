local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer

-- ========== SOUND SYSTEM ==========
local buttonClickSound = Instance.new("Sound")
buttonClickSound.SoundId = "rbxassetid://4499400560"
buttonClickSound.Parent = game:GetService("SoundService")

local function playClickSound()
    pcall(function() buttonClickSound:Play() end)
end

-- ========== MAIN GUI ==========
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NovatasticHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.Enabled = false -- Start hidden
ScreenGui.ZIndex = 1
ScreenGui.Parent = player:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0.4, 0, 0.4, 0)
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.new(0, 0, 0)
MainFrame.BackgroundTransparency = 0.5
MainFrame.Active = true
MainFrame.Parent = ScreenGui

-- ========== DEVICE SELECTION GUI ==========
local DeviceSelectionGui = Instance.new("ScreenGui")
DeviceSelectionGui.Name = "DeviceSelectionGui"
DeviceSelectionGui.Enabled = true
DeviceSelectionGui.ZIndex = 2 -- Above main GUI
DeviceSelectionGui.Parent = player.PlayerGui

local SelectionFrame = Instance.new("Frame")
SelectionFrame.Size = UDim2.new(0.6, 0, 0.4, 0)
SelectionFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
SelectionFrame.AnchorPoint = Vector2.new(0.5, 0.5)
SelectionFrame.BackgroundColor3 = Color3.new(0, 0, 0)
SelectionFrame.BackgroundTransparency = 0.5
SelectionFrame.ZIndex = 100
SelectionFrame.Parent = DeviceSelectionGui
 
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = SelectionFrame
 
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Text = "What's your device?"
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 24
Title.BackgroundTransparency = 1
Title.ZIndex = 101
Title.Parent = SelectionFrame
 
-- Buttons for device selection
local CellphoneButton = Instance.new("TextButton")
CellphoneButton.Size = UDim2.new(0.8, 0, 0, 40)
CellphoneButton.Position = UDim2.new(0.1, 0, 0.3, 0)
CellphoneButton.Text = "Cellphone"
CellphoneButton.TextColor3 = Color3.new(1, 1, 1)
CellphoneButton.BackgroundColor3 = Color3.new(0, 0.5, 1)
CellphoneButton.ZIndex = 101
CellphoneButton.Parent = SelectionFrame
 
local TabletButton = Instance.new("TextButton")
TabletButton.Size = UDim2.new(0.8, 0, 0, 40)
TabletButton.Position = UDim2.new(0.1, 0, 0.5, 0)
TabletButton.Text = "Tablet"
TabletButton.TextColor3 = Color3.new(1, 1, 1)
TabletButton.BackgroundColor3 = Color3.new(0, 0.5, 1)
TabletButton.ZIndex = 101
TabletButton.Parent = SelectionFrame
 
local PCButton = Instance.new("TextButton")
PCButton.Size = UDim2.new(0.8, 0, 0, 40)
PCButton.Position = UDim2.new(0.1, 0, 0.7, 0)
PCButton.Text = "Computer/PC"
PCButton.TextColor3 = Color3.new(1, 1, 1)
PCButton.BackgroundColor3 = Color3.new(0, 0.5, 1)
PCButton.ZIndex = 101
PCButton.Parent = SelectionFrame
 
-- Function to set main GUI size
local function setMainGuiSize(device)
    local widthScale, heightScale
    if device == "Cellphone" then
        widthScale, heightScale = 0.8, 0.6
    elseif device == "Tablet" then
        widthScale, heightScale = 0.6, 0.5
    else
        widthScale, heightScale = 0.4, 0.4
    end
    return UDim2.new(widthScale, 0, heightScale, 0)
end
 
-- Function to handle device selection
local function onDeviceSelected(device)
    playClickSound()
    DeviceSelectionGui:Destroy()
    local mainSize = setMainGuiSize(device)
    
    -- Ensure MainFrame exists and set its size
    if MainFrame then
        MainFrame.Size = mainSize
        ScreenGui.Enabled = true
        print("Main GUI enabled with size:", mainSize)
    else
        warn("MainFrame not found!")
    end
end
 
-- Connect buttons
CellphoneButton.MouseButton1Click:Connect(function()
    onDeviceSelected("Cellphone")
end)
 
TabletButton.MouseButton1Click:Connect(function()
    onDeviceSelected("Tablet")
end)
 
PCButton.MouseButton1Click:Connect(function()
    onDeviceSelected("Computer/PC")
end)
 
-- Create Main GUI (initially disabled)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NovatasticHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.Enabled = false
ScreenGui.Parent = player.PlayerGui
 
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0.4, 0, 0.4, 0) -- Default size, updated later
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.new(0, 0, 0)
MainFrame.BackgroundTransparency = 0.5
MainFrame.Active = true
MainFrame.Parent = ScreenGui
 
local UICornerMain = Instance.new("UICorner")
UICornerMain.CornerRadius = UDim.new(0, 8)
UICornerMain.Parent = MainFrame
 
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Text = "What's your device?"
Title.TextColor3 = Color3.new(1, 1, 1)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 24
Title.BackgroundTransparency = 1
Title.ZIndex = 101
Title.Parent = SelectionFrame
 
-- Buttons for device selection
local CellphoneButton = Instance.new("TextButton")
CellphoneButton.Size = UDim2.new(0.8, 0, 0, 40)
CellphoneButton.Position = UDim2.new(0.1, 0, 0.3, 0)
CellphoneButton.Text = "Cellphone"
CellphoneButton.TextColor3 = Color3.new(1, 1, 1)
CellphoneButton.BackgroundColor3 = Color3.new(0, 0.5, 1)
CellphoneButton.ZIndex = 101
CellphoneButton.Parent = SelectionFrame
 
local TabletButton = Instance.new("TextButton")
TabletButton.Size = UDim2.new(0.8, 0, 0, 40)
TabletButton.Position = UDim2.new(0.1, 0, 0.5, 0)
TabletButton.Text = "Tablet"
TabletButton.TextColor3 = Color3.new(1, 1, 1)
TabletButton.BackgroundColor3 = Color3.new(0, 0.5, 1)
TabletButton.ZIndex = 101
TabletButton.Parent = SelectionFrame
 
local PCButton = Instance.new("TextButton")
PCButton.Size = UDim2.new(0.8, 0, 0, 40)
PCButton.Position = UDim2.new(0.1, 0, 0.7, 0)
PCButton.Text = "Computer/PC"
PCButton.TextColor3 = Color3.new(1, 1, 1)
PCButton.BackgroundColor3 = Color3.new(0, 0.5, 1)
PCButton.ZIndex = 101
PCButton.Parent = SelectionFrame
 
print("Device Selection GUI created")  -- Debug print
 
-- Function to set main GUI size based on device using scale
local function setMainGuiSize(device)
    local widthScale, heightScale
    if device == "Cellphone" then
        widthScale, heightScale = 0.8, 0.6  -- 80% width, 60% height
    elseif device == "Tablet" then
        widthScale, heightScale = 0.6, 0.5  -- 60% width, 50% height
    else  -- Computer/PC
        widthScale, heightScale = 0.4, 0.4  -- 40% width, 40% height
    end
    return UDim2.new(widthScale, 0, heightScale, 0)
end
 
-- Connect button clicks
local function onDeviceSelected(device)
    playClickSound()
    DeviceSelectionGui:Destroy()
    local mainSize = setMainGuiSize(device)
    MainFrame.Size = mainSize
    ScreenGui.Enabled = true
    print("Main GUI enabled with size: " .. tostring(mainSize))  -- Debug print
end
 
CellphoneButton.MouseButton1Click:Connect(function()
    onDeviceSelected("Cellphone")
end)
 
TabletButton.MouseButton1Click:Connect(function()
    onDeviceSelected("Tablet")
end)
 
PCButton.MouseButton1Click:Connect(function()
    onDeviceSelected("Computer/PC")
end)
 
-- Create Main GUI (initially disabled)
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NovatasticHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.Enabled = false  -- Start disabled until device is selected
ScreenGui.Parent = player.PlayerGui
 
local MainFrame = Instance.new("Frame")
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)  -- Center on screen
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.new(0, 0, 0)
MainFrame.BackgroundTransparency = 0.5
MainFrame.Active = true
MainFrame.Parent = ScreenGui
 
local UICornerMain = Instance.new("UICorner")
UICornerMain.CornerRadius = UDim.new(0, 8)
UICornerMain.Parent = MainFrame
 
-- Title Bar
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1, 0, 0, 30)
TitleBar.BackgroundTransparency = 1
TitleBar.Parent = MainFrame
 
local TitleMain = Instance.new("TextLabel")
TitleMain.Size = UDim2.new(1, -70, 1, 0)
TitleMain.Text = "Novatastic Hub - Dead Rails"
TitleMain.TextColor3 = Color3.new(1, 1, 1)
TitleMain.Font = Enum.Font.GothamBold
TitleMain.TextSize = 18
TitleMain.Parent = TitleBar
 
local TitleGradient = Instance.new("UIGradient")
TitleGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.new(0, 0.5, 1)),
    ColorSequenceKeypoint.new(1, Color3.new(0, 0, 1))
})
TitleGradient.Rotation = -90
TitleGradient.Parent = TitleMain
 
-- Control Buttons
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
MinimizeButton.Position = UDim2.new(1, -60, 0.5, -12)
MinimizeButton.Text = "-"
MinimizeButton.TextColor3 = Color3.new(1, 1, 1)
MinimizeButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
MinimizeButton.Parent = TitleBar
 
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 25, 0, 25)
CloseButton.Position = UDim2.new(1, -30, 0.5, -12)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.BackgroundColor3 = Color3.new(1, 0, 0)
CloseButton.Parent = TitleBar
 
-- ScrollingFrame
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Size = UDim2.new(1, -10, 1, -50)
ScrollFrame.Position = UDim2.new(0, 5, 0, 40)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.ScrollBarThickness = 8
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollFrame.Parent = MainFrame
 
local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 10)
UIListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
UIListLayout.Parent = ScrollFrame
 
UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y)
end)
 
-- Button Factory
local function createButton(name)
    local button = Instance.new("TextButton")
    button.Size = UDim2.new(0.9, 0, 0, 60)
    button.Text = name
    button.TextColor3 = Color3.new(1, 1, 1)
    button.Font = Enum.Font.GothamBold
    button.TextSize = 18
    
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.new(0, 0.5, 1)),
        ColorSequenceKeypoint.new(1, Color3.new(0, 0, 1))
    })
    gradient.Rotation = -90
    gradient.Parent = button
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = button
    
    return button
end
 
-- ========== ANTI-DIE SYSTEM ==========
local function createButton(name)
    local button = Instance.new("TextButton")
    -- Your original button creation code
    return button
end

local AntiDieButton = createButton("Anti-Die")
local antiDieActive = false
local healthConnection

local function maintainImmortality()
    while antiDieActive and task.wait(0.3) do
        local character = player.Character
        if character and character:FindFirstChild("Humanoid") then
            character.Humanoid.Health = 100
        end
    end
end

AntiDieButton.MouseButton1Click:Connect(function()
    antiDieActive = not antiDieActive
    AntiDieButton.Text = antiDieActive and "Anti-Die [ON]" or "Anti-Die"
    if antiDieActive then
        maintainImmortality()
    end
end)

-- ========== NOCLIP SYSTEM ==========
local NoclipButton = createButton("Noclip")
local noclipActive = false
local noclipConnection

local function noclipCharacter(character)
    if character then
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end

NoclipButton.MouseButton1Click:Connect(function()
    noclipActive = not noclipActive
    NoclipButton.Text = noclipActive and "Noclip [ON]" or "Noclip"
    if noclipActive then
        noclipCharacter(player.Character)
    end
end)

-- ========== WELD TOOL SYSTEM ==========
local WeldToolButton = createButton("Weld Tool")
local weldIcon = Instance.new("ImageButton")
weldIcon.Image = "rbxassetid://7072717142"
weldIcon.ImageColor3 = Color3.new(1, 1, 1)
weldIcon.Visible = false
weldIcon.Parent = ScreenGui -- Critical parenting fix
local iconCorner = Instance.new("UICorner")
        iconCorner.CornerRadius = UDim.new(0, 12)
        iconCorner.Parent = weldIcon
    end
end
 
local function universalWeld(item)
    if not item then return end
    
    local mouse = player:GetMouse()
    local ray = Ray.new(mouse.UnitRay.Origin, mouse.UnitRay.Direction * 1000)
    local _, position = workspace:FindPartOnRay(ray)
    
    -- Create collision-enabled anchor
    local anchor = Instance.new("Part")
    anchor.Anchored = true
    anchor.CanCollide = true
    anchor.Transparency = 1
    anchor.Size = Vector3.new(2, 2, 2)  -- Increased size for better collision
    anchor.Position = position
    anchor.Parent = workspace
    
    -- Force collision properties
    if item:IsA("Model") then
        local primary = item.PrimaryPart or item:FindFirstChildWhichIsA("BasePart")
        if primary then
            primary.CanCollide = true
            primary.Anchored = false
        end
        for _, part in pairs(item:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
                part.Anchored = false
                part.Massless = false
            end
        end
    elseif item:IsA("BasePart") then
        item.CanCollide = true
        item.Anchored = false
        item.Massless = false
    end
    
    -- Physics refresh
    RunService.Heartbeat:Wait()
    
    -- Fire weld event
    local args = { item, anchor }
    game:GetService("ReplicatedStorage"):WaitForChild("Shared"):WaitForChild("Network"):WaitForChild("RemoteEvent"):WaitForChild("RequestWeld"):FireServer(unpack(args))
    
    -- Continuous collision enforcement
    spawn(function()
        while item.Parent do
            if item:IsA("Model") then
                for _, part in pairs(item:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = true
                        part.Massless = false
                    end
                end
            elseif item:IsA("BasePart") then
                item.CanCollide = true
                item.Massless = false
            end
            RunService.Heartbeat:Wait()
        end
    end)
    
    -- Anchor cleanup
    game:GetService("Debris"):AddItem(anchor, 5)
end
 
WeldToolButton.MouseButton1Click:Connect(function()
    createWeldIcon()
    weldIcon.Visible = not weldIcon.Visible
end)
 
createWeldIcon()
weldIcon.MouseButton1Click:Connect(function()
    if not isDraggingItem then
        local args = {workspace:WaitForChild("RuntimeItems"):WaitForChild("Newspaper")}
        game:GetService("ReplicatedStorage"):WaitForChild("Shared"):WaitForChild("Network"):WaitForChild("RemoteEvent"):WaitForChild("RequestStartDrag"):FireServer(unpack(args))
        weldIcon.ImageColor3 = Color3.new(0, 1, 0)
        isDraggingItem = true
    else
        game:GetService("ReplicatedStorage"):WaitForChild("Shared"):WaitForChild("Network"):WaitForChild("RemoteEvent"):WaitForChild("RequestStopDrag"):FireServer()
        universalWeld(workspace:WaitForChild("RuntimeItems"):WaitForChild("Newspaper"))
        weldIcon.ImageColor3 = Color3.new(1, 1, 1)
        isDraggingItem = false
    end
end)
 
-- ========== KILL ALL ENTITIES ==========
-- Variables for Kill All Entities feature
local killEntitiesActive = false
local targetModelNames = {
"Model_ShotgunOutlaw",
"Model_ArmoredZombie",
"Model_Runner",
"Model_Walker",
"Model_ZombieSheriff"
}
 
-- Function to continuously kill entities
local function killEntitiesLoop()
while killEntitiesActive do
for _, descendant in pairs(workspace:GetDescendants()) do
if descendant:IsA("Model") and table.find(targetModelNames, descendant.Name) then
local humanoid = descendant:FindFirstChildOfClass("Humanoid")
if humanoid then
humanoid.Health = 0
                end
            end
        end
        wait(1) -- Wait 1 second between iterations
    end
end
 
-- Create the "Kill All Entities" button
local KillEntitiesButton = createButton("Kill All Entities")
 
-- Connect the button's click event
KillEntitiesButton.MouseButton1Click:Connect(function()
killEntitiesActive = not killEntitiesActive
    KillEntitiesButton.Text = killEntitiesActive and "Kill All Entities [ON]" or "Kill All Entities"
   
    if killEntitiesActive then
        spawn(killEntitiesLoop) -- Start the loop in a separate thread
  end
end)
-- ========== AUTO-BONDS ==========
local AutoBondsButton = createButton("Auto-Bonds")

AutoBondsButton.MouseButton1Click:Connect(function()
    pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/thiennrb7/Script/main/autobond"))()
    end)
end)

-- ========== FINAL SETUP ==========
-- Device selection handler (FIXED)
local function onDeviceSelected(device)
    playClickSound()
    DeviceSelectionGui:Destroy()
    
    MainFrame.Size = ({
        Cellphone = UDim2.new(0.8, 0, 0.6, 0),
        Tablet = UDim2.new(0.6, 0, 0.5, 0),
        ["Computer/PC"] = UDim2.new(0.4, 0, 0.4, 0)
    })[device]
    
    ScreenGui.Enabled = true
    if UIS.TouchEnabled then
        ScreenGui.IgnoreGuiInset = true
    end
end

-- Parent all buttons
for _, btn in pairs({AntiDieButton, NoclipButton, WeldToolButton, KillEntitiesButton, AutoBondsButton}) do
    btn.Parent = ScrollFrame
end
